要件定義書

1. 機能要件

1.1. 音声ファイル入力/管理

ファイルリスト表示: メイン画面に処理対象ファイルリストを表示 (ファイル名, ステータス, 言語, 処理時間など)。

ファイル追加: 「ファイル追加」ボタンで複数ファイルを選択しリストに追加。ドラッグ＆ドロップは実装しない。

ファイル削除: リストから選択したファイルを個別に削除。

全ファイル削除: リスト内の全ファイルを一括削除。

対応形式: ffmpeg が対応する主要音声形式 (MP3, WAV, M4A, FLAC, OGG, AAC, WMA等)。

ファイルサイズ: 上限は設けないが、巨大ファイルに関する注意喚起を行う。

1.2. 文字起こし実行

一括処理: 「処理開始」ボタンでリスト内の「待機中」ファイルを上から順に逐次処理。

処理エンジン: FasterWhisper (largeモデル) を使用。

言語指定:

ファイルリストの各行で個別に言語を指定可能 (ドロップダウンリスト)。

主要言語 (日本語, 英語, 中国語等) を選択可能。日本語をデフォルトとする。

選択した複数ファイルに一括で言語を設定するボタンを提供。(TODO)

言語自動検出機能は実装しない。

タスク指定: 「文字起こし (transcribe)」のみ。

処理停止: 「停止」ボタンを提供。押下後、現在処理中のファイルは完了させてからキュー処理を停止。UIでその旨を通知。(TODO)

1.3. 進捗表示

ファイルリスト内で各ファイルのステータス (待機中, 処理中, 完了, エラー) をリアルタイム更新。

ステータスバー等で全体の進捗状況 (例: 処理中: 3/10件完了) を表示。(TODO)

1.4. 結果表示

ファイルリストで完了したファイルを選択すると、専用エリアに結果を表示 (選択切り替え可能)。

表示内容は2部構成:

前半: テキストのみ (セグメント間は空行で区切る)。

後半: タイムスタンプ付きテキスト ([HH:MM:SS.ms --> HH:MM:SS.ms])。

前半と後半の間に区切り線/ヘッダーを挿入。

1.5. 結果出力 (2025-04-05 仕様変更)

自動保存: 文字起こし完了時に、プレーンテキスト結果を `.txt` ファイルとして自動保存。

手動ダウンロード: 結果表示ビューから、タイムスタンプ付きテキストを `.txt` ファイル (元のファイル名\_timestamps.txt) として手動でダウンロード可能。

クリップボードコピー: 結果表示ビューから、表示中の結果全体 (プレーンテキストとタイムスタンプ付きテキスト) をコピー。

1.6. 設定画面 (タブ形式)

一般タブ: デフォルト言語、デフォルト出力フォルダ指定。

モデルタブ: モデルパス確認 (設定ファイルの値)、GPU/CPU利用状況表示 (自動検出結果)。

出力タブ: (仕様変更により削除)

1.7. ライセンス認証

初回起動時等にライセンスキー入力を要求。

ハードウェアフィンガープリント (CPU ID, マザーボードシリアル等) と紐付けてキーを検証・保存 (暗号化)。

保存場所: %APPDATA%\YourAppName 内のファイル or レジストリ。

再アクティベーションは手動サポート対応。

1.8. バージョン情報 (About画面) (TODO)

アプリバージョン、ライブラリ帰属表示 (Flet, FasterWhisper, OpenAI, PyTorch, CTranslate2, Python, ffmpeg等)。

2. 非機能要件

2.1. 性能

実行エンジン: FasterWhisper (largeモデル)

実行環境: NVIDIA GPU (CUDA) を自動検出し利用。利用不可時はCPUに自動フォールバック。GPUの手動選択は不可。

処理方式: 複数ファイルは逐次処理。

UI応答性: 処理中もUIはフリーズせず、基本操作が可能。大量ファイルリストでも軽快動作を目指す (必要なら仮想スクロール等検討)。

タイムスタンプ精度: FasterWhisper が提供する標準的な精度。フォーマット固定。

2.2. プラットフォーム

対応OS: Windows 10 / 11 (64bit)。最低ビルド要件は要調査。

2.3. ユーザーインターフェース (UI)

フレームワーク: Flet

構成: 左ペイン(ファイルリスト等) + 右ペイン(結果表示等) + ステータスバー + メニュー/設定ボタン。

デザイン: シンプル、直感的。

2.4. 配布・インストール

媒体: セットアップ用USBメモリ (インストーラー格納)。

形式: Windowsインストーラー (.exe, Inno Setupで作成)。

同梱物: アプリ本体, 依存ライブラリ (Python含む), FasterWhisper largeモデル, ffmpeg 実行ファイル。

2.5. セキュリティ

データ処理: 完全オフライン、ローカルPC内で完結。

ライセンス: ライセンスキー認証による不正利用防止。

2.6. 商用利用

商用ライセンスとして提供。

利用ライブラリのライセンス条項遵守 (帰属表示含む)。

2.7. 保守性・運用

設定: %APPDATA%\YourAppName 内の INI ファイルに保存。

エラーログ: %APPDATA%\YourAppName\logs\ にファイルとして記録 (INFOレベル以上)。UI上では簡単なエラー表示に留める。

アップデート: 自動更新機能なし。手動でのインストーラー上書きインストール。

2.8. その他

ファイルリスト上限: 明確な制限なし。UIでの注意喚起。

3. 制約条件

開発言語: Python

主要技術: Flet, FasterWhisper, PyTorch, PyInstaller, Inno Setup, ffmpeg

Whisper large モデルの使用必須。

オフライン動作前提。
